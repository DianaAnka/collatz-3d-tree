<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Collatz 3D Tree â€” Flashy</title>
  <style>
    body { margin: 0; overflow: hidden; background-color: #111; }
    #graph { width: 100vw; height: 100vh; }
  </style>
</head>
<body>
<div id="graph"></div>

<!-- 3D Force Graph library -->
<script src="https://unpkg.com/3d-force-graph"></script>

<script>
  // Configuration
  const maxN = 2000; // number of nodes, adjust for performance
  const nodes = [];
  const links = [];
  
  // Flashy rainbow colors
  const colors = ['#e6194b','#3cb44b','#ffe119','#4363d8','#f58231','#911eb4','#46f0f0','#f032e6','#bcf60c','#fabebe'];

  // Collatz next function
  function collatzNext(n) {
    return (n % 2 === 0) ? n / 2 : 3 * n + 1;
  }

  // Create nodes
  for (let i = 1; i <= maxN; i++) {
    nodes.push({ id: i });
  }

  // Create links
  for (let i = 1; i <= maxN; i++) {
    const t = collatzNext(i);
    if (t <= maxN) {
      links.push({ source: i, target: t });
    } else {
      // optional: show where numbers go beyond maxN
      nodes.push({ id: t });
      links.push({ source: i, target: t });
    }
  }

  // Initialize 3D Force Graph
  const Graph = ForceGraph3D()(document.getElementById('graph'))
    .graphData({ nodes, links })
    .nodeColor(node => colors[node.id % colors.length])  // flashy rainbow colors
    .nodeLabel(node => `n=${node.id}`)
    .nodeRelSize(2)
    .linkDirectionalParticles(1)          // particles along links
    .linkDirectionalParticleSpeed(0.01)
    .linkWidth(0.5)
    .showNavInfo(false);

  // Adjust forces to spread nodes nicely
  Graph.d3Force('charge').strength(-30);
  Graph.d3Force('link').distance(6);

  // Optional: click a node to zoom
  Graph.onNodeClick(node => {
    const distance = 200;
    const distRatio = 1 + distance / Math.hypot(node.x, node.y, node.z);
    Graph.cameraPosition(
      { x: node.x * distRatio, y: node.y * distRatio, z: node.z * distRatio },
      { x: node.x, y: node.y, z: node.z },
      1500
    );
  });
</script>
</body>
</html>
